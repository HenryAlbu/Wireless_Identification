![](data:image/png;base64,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)

**Table of Contents**

[TOC]

# How To Replicate

DISCLOSURE: these steps were done on two Raspberry  Pi Model 3. We are unsure if the following steps will work on older models. 

### Raspberry Pi #1 (Main Pi):
The Main Pi will be the one located in the entrance of the building. It is known as the Main Pi because it will have a lot more scripts running on it than the other Pi. It also servers as the server that runs the database and hosts the captive portal for when a user first logs in.

**Step 1:** Install the latest version of [RaspbianOS](https://www.raspberrypi.org/downloads/raspbian/ "RaspbianOS"). We used version (September 2019).

**Step 2:** Install Apache. We used version (2.4.38).
`sudo apt install apache2`

**Step 3:** Install MySql. We used version (15.1)
`sudo apt install mysql-server`

**Step 4:** Install PHP. We used version (7.3.9-1) 
`sudo apt install php libapache2-mod-php php-mysql`

**Step 5:** Import the sql file located in the "database" folder into the mysql database 

**Step 6:** Install NoDogSplash. Nodogsplash is a Captive Portal that offers a simple way to provide restricted access to the Internet by showing a splash page to the user before Internet access is granted. We used version (4.3). We followed the instructions [here](https://pimylifeup.com/raspberry-pi-captive-portal/ "here") to install NoDogSplash.

**Step 7:** Replace the default captive portal page with the custom portal located in this github repo (PI1/dashboard). 

**Step 8:** Make the scripts named "repeater.sh" and "onHostapdChange.sh" located in the "PI1" folder run on device startup. 

**Step 9:** Place the folders "splash", "dashboard", and "scripts" located in the folder "PI1" into the directory (/etc/www/html) of the Pi.


### Raspberry Pi #2:

**Step 1:** Change Line #1 of "PI2/scripts/checker.php" and "PI2/scripts/repeat.php" to reflect the IP of the Main Pi in order to update the database.
`$conn = mysqli_connect('MAIN_PI_IP', 'pi2', 'piDBpassword', 'tracking_system');
`

**Step 2:** Make the scripts named "repeater.sh" and "onHostapdChange.sh" located in the "PI2" folder run on device startup.

# Folders/Scripts And What They Do

Shell Scripts

File  | Function
------------- | -------------
repeater.sh  |  This is a shell script that runs on boot every second. The objective of this file is to run the reapeat.php and inserter.php files
onHostapdChange.sh  | This is shell script runs on boot and runs in the background in order to check when a device is connected and disconnected. It runs the checker.php and inserter.php

PHP Scripts

File  | Function
------------- | -------------
inserter.php  | Inserts user into the tracking table (sets ip and mac into tracking)
checker.php  | Runs the same function as repeter.php to set the mac in the users table just in case the repeater.sh that runs every 10 secs fails this will launch on connect and disconnect. Also sets 0 or 1 if connected or disconnected into the tracking table
reapeat.php  | Sets the mac into the users table. It also sets the signal streght into the tracking table. 

Folders

Folders  | Function
------------- | -------------
PI1/dashboard  | Hosts all the files needed for the dashboard
PI1/scripts  | Hosts all the php scripts needed for PI2
P11/splash  | Hosts the custom splash screen a user sees when connecting to WiFi
PI2/scripts  | Hosts all the php scripts needed for PI2
database  | Contains the tracking_system.sql file
